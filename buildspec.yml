version: 0.2

env:
  variables:
    RUBY_VERSION: "2.6"

phases:
  install:
    runtime-versions:
      ruby: "$RUBY_VERSION"
    commands:
      - apt-get update -y
      - pip3 install awscli --upgrade --user
      - gem install rails
      - bundle update --group test
  pre_build:
    commands:
      - eval "$(aws ecr get-login --no-include-email)"
  build:
    commands:
      - bin/spring stop
      - rails test
      - docker build -t airport-hangout-frontend:$(cat VERSION.txt).$(date -u +%Y%m%d%H%M%S) .
  post_build:
    commands:
      - echo "Placeholder for docker push"
