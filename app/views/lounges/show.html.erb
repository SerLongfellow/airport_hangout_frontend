
<h2><%= @lounge.name %></h2>

<p><%= link_to("Back to Lounges...", airport_lounges_path) %></p>

<p><%= @lounge.description %></p>
<p>Current Patrons: <%= @lounge.number_of_patrons %></p>

<% if @user.current_lounge.nil? %>

  <p><%= link_to("Check in!", airport_lounge_patrons_path(@lounge.airport.id, @lounge.id), method: :post) %></p>

<% elsif @lounge.id == @user.current_lounge.id %>

  <p>You're currently checked into this lounge! Meet some friends!</p>
  <p><%= link_to("Check out", airport_lounge_patron_path(@lounge.airport.id, @lounge.id, @user.id), method: :delete) %></p>

<% else %>

  <p>You're currently checked into <%= @user.current_lounge.name %>. <%= link_to("Click here", airport_lounge_patrons_path(@lounge.airport.id, @lounge.id), method: :post) %> to leave and check into this lounge.</p>
<% end %>

<script type="text/javascript">
  function getPatrons() {
    $.ajax({
      type: "get",
      url: "<%= airport_lounge_patrons_path(@lounge.airport.id, @lounge.id) %>",
      dataType: "html",
      success: function(data) {
        $("#patrons_list").html(data);
      },
      error: function(data) {
        $("#patrons_list").html("<p>Failure fetching patrons!</p>");
      }
    });
  }
</script>

<h3>Patrons</h3>
<a href="#" onclick="getPatrons()">Refresh List</a>
<div id="patrons_list"></div>

<script type="text/javascript">
  $(document).ready(function() {
    getPatrons();
  });
</script>

<h3>Airport</h3>
<p><%= @lounge.airport.name %></p>
<p><%= @lounge.airport.code %></p>

